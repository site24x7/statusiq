<!-- Below code is to seperate Historic Maintenance and Historic Incident in Incident History section -->

<!-- Paste the following into your Custom Footer section -->


<script type="text/javascript">
  $( document ).ready(function() {
  if (window.location.href.indexOf('incident_history') !== -1) {
    return;
  }
  var $maintenanceContainer = $('<di id="maintenance-cards"><h2 class="h3 ml-0 ml-sm-3">Historic Maintenance</h2></div>');
  var $incidentContainer = $('<div id="incident-cards"><h2 class="h3 ml-0 ml-sm-3">Historic Incident</h2></div>');
  var maintenanceFound = false;

  $('#spIncidentHistory .card').each(function() {
    var $card = $(this);
    var $dateHeader = $card.find('h3').first().clone();
    var $border = $card.find('.border-bottom').first().clone();

    var $entries = $card.children('.py-2.mb-2, .my-3');
    var $maintEntries = $entries.filter(function() {
      return $(this).find('.maintenance').length > 0;
    });
    var $incidentEntries = $entries.filter(function() {
      return $(this).find('.maintenance').length === 0;
    });

    if ($maintEntries.length) {
      maintenanceFound = true;
      var $maintCard = $('<div class="card px-3 py-2 mb-2"></div>');
      $maintCard.append($dateHeader.clone(), $border.clone());
      $maintEntries.each(function() { $maintCard.append($(this).clone()); });
      $maintenanceContainer.append($maintCard);
    }

    if ($incidentEntries.length) {
      var $incidentCard = $('<div class="card px-3 py-2 mb-2"></div>');
      $incidentCard.append($dateHeader.clone(), $border.clone());
      $incidentEntries.each(function() { $incidentCard.append($(this).clone()); });
      $incidentContainer.append($incidentCard);
    }
  });

  // If no maintenance found, add a "No historic maintenance" card
  if (!maintenanceFound) {
    var $noMaintCard = $('<div class="card px-3 py-2 mb-2 text-center"><div class="mb-5 mt-5"> No historic maintenance</div></div>');
    $maintenanceContainer.append($noMaintCard);
  }

  $('#spIncidentHistory').empty().append($maintenanceContainer, $incidentContainer);
});

</script>
